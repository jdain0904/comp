#include <bits/stdc++.h>

#define ll long long
#define endl "\n"

using namespace std;

ll h, w;
vector <vector<ll>> board, cnt;
ll dx[]={1, 1, 0, -1, -1, -1, 0, 1};
ll dy[]={0, -1, -1, -1, 0, 1, 1, 1};

queue <pair<ll, ll>> q;

int main()
{
    cin>>h>>w;

    board.resize(h+2, vector<ll>(w+2, 0));
    cnt.resize(h+2, vector<ll>(w+2, 0));

    for(ll i=1; i<=h; i++)
    {
        for(ll j=1; j<=w; j++)
        {
            char c;
            cin>>c;
            if(c=='.')
            {
                board[i][j]=0;
                for(ll t=0; t<8; t++)
                {
                    cnt[i+dy[t]][j+dx[t]]++;
                }
            }
            else board[i][j]=c-'0';
        }
    }

    for(ll i=1; i<=h; i++)
    {
        for(ll j=1; j<=w; j++)
        {
            if(board[i][j]&&board[i][j]<=cnt[i][j]){
                board[i][j]=0;
                q.push({i, j});
            }
        }
    }

    ll stage=0;

    while(!q.empty())
    {
        stage++;
        queue <pair<ll, ll>> cur=q;
        q=queue<pair<ll, ll>>();

        while(!cur.empty())
        {
            pair<ll, ll> x=cur.front();
            cur.pop();

            for(ll i=0; i<8; i++)
            {
                ll nx=x.first+dy[i];
                ll ny=x.second+dx[i];

                if(board[nx][ny]&&board[nx][ny]<=++cnt[nx][ny]) {
                    board[nx][ny]=0;
                    q.push({nx, ny});
                }
            }
        }
    }
    cout<<stage;

    return 0;
}
